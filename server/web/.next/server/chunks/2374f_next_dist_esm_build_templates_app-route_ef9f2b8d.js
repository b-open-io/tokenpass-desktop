module.exports=[45068,e=>{"use strict";var t,r,i=e.i(98490),a=e.i(18006),n=e.i(95912),o=e.i(72560),s=e.i(76852),l=e.i(38533),d=e.i(55822),u=e.i(54068),c=e.i(66843),p=e.i(99385),h=e.i(54196),f=e.i(75293),g=e.i(2144),m=e.i(33599),v=e.i(36497),w=e.i(93695);e.i(79178);var b=e.i(96717),I=e.i(23480);let y="https://ordfs.network",R=/^[a-fA-F0-9]{64}$/,x=/^\d+$/,E=/^[1-9A-HJ-NP-Za-km-z]{25,34}$/,T=/^data:([^;]+)(;base64)?,(.*)$/,C=/^(b|ord|bitfs|ipfs):\/\/(.+)$/,P="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjEwMCIgeT0iMTAwIiBzdHlsZT0iZmlsbDojYWFhO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjEzcHg7Zm9udC1mYW1pbHk6QXJpYWwsSGVsdmV0aWNhLHNhbnMtc2VyaWY7ZG9taW5hbnQtYmFzZWxpbmU6Y2VudHJhbCI+Tm8gSW1hZ2U8L3RleHQ+PC9zdmc+";(t=r||(r={})).Bitcoin="b",t.Ordinals="ord",t.BitFS="bitfs",t.IPFS="ipfs",t.DataURI="data",t.HTTP="http",t.Native="native",t.Unknown="unknown";let N=e=>{if(!e.txid)throw Error("Missing transaction ID");let t=e.vout??0;return`${y}/${e.txid}_${t}`},U=e=>{if(!e.txid)throw Error("Missing transaction ID");return void 0!==e.vout?`${y}/${e.txid}_${e.vout}`:`${y}/${e.txid}`},$=e=>{if(!e.txid)throw Error("Missing transaction ID");return void 0!==e.vout?`${y}/${e.txid}_${e.vout}`:`https://x.bitfs.network/${e.txid}`},A=e=>{if(!e.hash)throw Error("Missing IPFS hash");return`https://ipfs.io/ipfs/${e.hash}`},V=e=>e.original,H=e=>e.original,S=e=>{if(!e.txid)throw Error("Missing transaction ID");let t=e.vout??0;return`${y}/${e.txid}_${t}`};function D(e){return R.test(e)}function k(e){return"number"==typeof e?e>=0&&Number.isInteger(e):x.test(e)&&Number.parseInt(e,10)>=0}function O(e){return E.test(e)}function _(e){return T.test(e)}function M(e){return C.test(e)}function F(e){return e.startsWith("Qm")&&46===e.length||e.startsWith("baf")&&e.length>=59}e.s(["isProtocolUrl",()=>M,"isValidAddress",()=>O,"isValidDataUri",()=>_,"isValidIPFSHash",()=>F,"isValidTxid",()=>D,"isValidVout",()=>k],2105),e.i(2105);class W{constructor(e={}){this.config={handlers:e.handlers||{},defaultGateway:e.defaultGateway||P,fallbackImage:e.fallbackImage||P,validateTxid:!1!==e.validateTxid,cacheEnabled:!1!==e.cacheEnabled,cacheTTL:e.cacheTTL||3600,proxy:e.proxy};const t={[r.Bitcoin]:N,[r.Ordinals]:U,[r.BitFS]:$,[r.IPFS]:A,[r.DataURI]:V,[r.HTTP]:H,[r.Native]:S,[r.Unknown]:()=>{throw Error("Unknown protocol")}};for(const[e,r]of(this.handlers={...t},Object.entries(this.config.handlers)))r&&(this.handlers[e]=r);this.cache=new Map}parse(e,t){return function(e,t={}){let{strict:i=!1,allowNativeTxid:a=!0}=t;if(!e||"string"!=typeof e)return{protocol:r.Unknown,original:e||"",isValid:!1,error:"Invalid input"};let n=e.trim();if(n.startsWith("data:"))return function(e){let t=e.match(T);if(!t)return{protocol:r.DataURI,original:e,isValid:!1,error:"Invalid data URI format"};let[,i,,a]=t;return{protocol:r.DataURI,original:e,mimeType:i,data:a,isValid:!0}}(n);if(n.startsWith("http://")||n.startsWith("https://"))return{protocol:r.HTTP,original:n,isValid:!0};let o=n.match(C);if(o){let[,e,t]=o;switch(e.toLowerCase()){case"b":var s,l,d=n,u=t;let i=u.split("_"),a=i[0],g=i[1];if(!D(a))return{protocol:r.Bitcoin,original:d,isValid:!1,error:"Invalid transaction ID"};let m={protocol:r.Bitcoin,original:d,txid:a,isValid:!0};if(void 0!==g){if(!k(g))return{...m,isValid:!1,error:"Invalid output index"};m.vout=Number.parseInt(g,10)}return m;case"ord":let v,w;var c=n,p=t;if(p.includes("_")?[v,w]=p.split("_"):p.includes(".")?[v,w]=p.split("."):v=p,!D(v))return{protocol:r.Ordinals,original:c,isValid:!1,error:"Invalid transaction ID"};let b={protocol:r.Ordinals,original:c,txid:v,isValid:!0};if(void 0!==w){if(!k(w))return{...b,isValid:!1,error:"Invalid output index"};b.vout=Number.parseInt(w,10)}return b;case"bitfs":var h=n,f=t;let I=f.split("."),y=I[0];if(!D(y))return{protocol:r.BitFS,original:h,isValid:!1,error:"Invalid transaction ID"};let R={protocol:r.BitFS,original:h,txid:y,isValid:!0};if(I.length>=3&&"out"===I[1]){let e=I[2];if(!k(e))return{...R,isValid:!1,error:"Invalid output index"};R.vout=Number.parseInt(e,10)}return R;case"ipfs":return s=n,F(l=t)?{protocol:r.IPFS,original:s,hash:l,isValid:!0}:{protocol:r.IPFS,original:s,isValid:!1,error:"Invalid IPFS hash"};default:return{protocol:r.Unknown,original:n,isValid:!1,error:`Unknown protocol: ${e}`}}}return a?function(e){let t=e.startsWith("/")?e.slice(1):e;if(t.startsWith("content/")&&(t=t.slice(8)),t.includes("_")){let[i,a]=t.split("_");if(D(i)&&k(a))return{protocol:r.Native,original:e,txid:i,vout:Number.parseInt(a,10),isValid:!0}}if(t.includes(".")){let[i,a]=t.split(".");if(D(i)&&k(a))return{protocol:r.Native,original:e,txid:i,vout:Number.parseInt(a,10),isValid:!0}}let i=t.match(/^([a-fA-F0-9]{64})([oi])(\d+)$/);if(i){let[,t,a,n]=i;if(D(t)&&k(n))return{protocol:r.Native,original:e,txid:t,vout:Number.parseInt(n,10),isValid:!0}}return D(t)?{protocol:r.Native,original:e,txid:t,isValid:!0}:{protocol:r.Unknown,original:e,isValid:!1,error:"Invalid format"}}(n):{protocol:r.Unknown,original:n,isValid:!1,error:"Unrecognized format"}}(e,t)}async getDisplayUrl(e,t={}){let{fallback:r=this.config.fallbackImage,timeout:i=3e4}=t;try{let t;if(this.config.cacheEnabled){let t=this.getFromCache(e);if(t)return t}let a=this.parse(e);if(!a.isValid)return console.warn(`Invalid image URL: ${e}`,a.error),r;let n=this.handlers[a.protocol];if(!n)return console.warn(`No handler for protocol: ${a.protocol}`),r;return t=i>0?await this.withTimeout(n(a),i):await n(a),t=this.applyProxy(t,a.protocol),this.config.cacheEnabled&&this.addToCache(e,t),t}catch(t){return console.error(`Error getting display URL for ${e}:`,t),r}}async getDisplayUrls(e,t={}){let r=new Map,i=[];for(let t=0;t<e.length;t+=10)i.push(e.slice(t,t+10));for(let e of i){let i=e.map(async e=>{let i=await this.getDisplayUrl(e,t);r.set(e,i)});await Promise.all(i)}return r}validate(e){let t=this.parse(e);return{isValid:t.isValid,error:t.error}}registerHandler(e,t){this.handlers[e]=t}clearCache(){this.cache.clear()}getCacheStats(){return{size:this.cache.size,hits:0,misses:0}}getFallbackImage(){return this.config.fallbackImage}getFromCache(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>1e3*this.config.cacheTTL?(this.cache.delete(e),null):t.url:null}addToCache(e,t){if(this.cache.set(e,{url:t,timestamp:Date.now()}),this.cache.size>1e3){let e=this.cache.keys().next().value;e&&this.cache.delete(e)}}async withTimeout(e,t){return e instanceof Promise?Promise.race([e,new Promise((e,r)=>setTimeout(()=>r(Error("Timeout")),t))]):e}applyProxy(e,t){let{proxy:i}=this.config;if(!i||!(i.protocols||[r.HTTP]).includes(t)||e.startsWith("data:")||e.startsWith("/")&&!e.startsWith("//"))return e;let a=i.transforms||"",n=encodeURIComponent(e);return a?`${i.url}/${a}/${n}`:`${i.url}/${n}`}}async function j(e,t){return new W().getDisplayUrl(e,t)}async function B(e){if(!e)return e;if(e.startsWith("/")&&/^\/[a-fA-F0-9]{64}/.test(e))return`https://ordfs.network${e}`;try{return await j(e)}catch{return e}}async function Z(e){try{let t=new AbortController,r=setTimeout(()=>t.abort(),5e3),i=await fetch("https://api.sigmaidentity.com/api/v1/identity/get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idKey:e}),signal:t.signal});if(clearTimeout(r),!i.ok)return console.warn(`[bap] Profile not found for ${e.substring(0,15)}...`),null;let a=await i.json(),n="OK"===a.status?a.result:null;if(!n)return null;return"_"in n&&(n.txHash=n._,delete n._),n.identity&&(n.identity.image&&(n.identity.image=await B(n.identity.image)),n.identity.logo&&(n.identity.logo=await B(n.identity.logo)),n.identity.banner&&(n.identity.banner=await B(n.identity.banner))),n}catch(t){return t instanceof Error&&"AbortError"===t.name?console.warn(`[bap] Timeout fetching profile for ${e.substring(0,15)}...`):console.error("[bap] Error fetching profile:",t),null}}async function q(e){let t=e.nextUrl.searchParams.get("idKey");if(!t)return I.NextResponse.json({error:"idKey parameter required"},{status:400});try{let e=await Z(t);if(!e)return I.NextResponse.json({error:"Profile not found"},{status:404});return I.NextResponse.json(e)}catch(e){return console.error("[bap-profile] Error fetching profile:",e),I.NextResponse.json({error:"Failed to fetch profile"},{status:500})}}e.s(["GET",()=>q],7609);var L=e.i(7609);let z=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/bap-profile/route",pathname:"/api/bap-profile",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/web/src/app/api/bap-profile/route.ts",nextConfigOutput:"standalone",userland:L}),{workAsyncStorage:G,workUnitAsyncStorage:K,serverHooks:Q}=z;function J(){return(0,n.patchFetch)({workAsyncStorage:G,workUnitAsyncStorage:K})}async function Y(e,t,r){z.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/bap-profile/route";i=i.replace(/\/index$/,"")||"/";let n=await z.prepare(e,t,{srcPage:i,multiZoneDraftMode:!1});if(!n)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:I,params:y,nextConfig:R,parsedUrl:x,isDraftMode:E,prerenderManifest:T,routerServerContext:C,isOnDemandRevalidate:P,revalidateOnlyGenerated:N,resolvedPathname:U,clientReferenceManifest:$,serverActionsManifest:A}=n,V=(0,d.normalizeAppPath)(i),H=!!(T.dynamicRoutes[V]||T.routes[U]),S=async()=>((null==C?void 0:C.render404)?await C.render404(e,t,x,!1):t.end("This page could not be found"),null);if(H&&!E){let e=!!T.routes[U],t=T.dynamicRoutes[V];if(t&&!1===t.fallback&&!e){if(R.experimental.adapterPath)return await S();throw new w.NoFallbackError}}let D=null;!H||z.isDev||E||(D="/index"===(D=U)?"/":D);let k=!0===z.isDev||!H,O=H&&!k;A&&$&&(0,l.setManifestsSingleton)({page:i,clientReferenceManifest:$,serverActionsManifest:A});let _=e.method||"GET",M=(0,s.getTracer)(),F=M.getActiveScopeSpan(),W={params:y,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!R.experimental.authInterrupts},cacheComponents:!!R.cacheComponents,supportsDynamicResponse:k,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:R.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,i,a)=>z.onRequestError(e,t,i,a,C)},sharedContext:{buildId:I}},j=new u.NodeNextRequest(e),B=new u.NodeNextResponse(t),Z=c.NextRequestAdapter.fromNodeNextRequest(j,(0,c.signalFromNodeResponse)(t));try{let n=async e=>z.handle(Z,W).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=M.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${_} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${_} ${i}`)}),l=!!(0,o.getRequestMeta)(e,"minimalMode"),d=async o=>{var s,d;let u=async({previousCacheEntry:a})=>{try{if(!l&&P&&N&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await n(o);e.fetchMetrics=W.renderOpts.fetchMetrics;let s=W.renderOpts.pendingWaitUntil;s&&r.waitUntil&&(r.waitUntil(s),s=void 0);let d=W.renderOpts.collectedTags;if(!H)return await (0,f.sendResponse)(j,B,i,W.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(i.headers);d&&(t[v.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==W.renderOpts.collectedRevalidate&&!(W.renderOpts.collectedRevalidate>=v.INFINITE_CACHE)&&W.renderOpts.collectedRevalidate,a=void 0===W.renderOpts.collectedExpire||W.renderOpts.collectedExpire>=v.INFINITE_CACHE?void 0:W.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==a?void 0:a.isStale)&&await z.onRequestError(e,t,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:P})},!1,C),t}},c=await z.handleResponse({req:e,nextConfig:R,cacheKey:D,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:N,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:l});if(!H)return null;if((null==c||null==(s=c.value)?void 0:s.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(d=c.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",P?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,g.fromNodeOutgoingHttpHeaders)(c.value.headers);return l&&H||p.delete(v.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,m.getCacheControlHeader)(c.cacheControl)),await (0,f.sendResponse)(j,B,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};F?await d(F):await M.withPropagatedContext(e.headers,()=>M.trace(p.BaseServerSpan.handleRequest,{spanName:`${_} ${i}`,kind:s.SpanKind.SERVER,attributes:{"http.method":_,"http.target":e.url}},d))}catch(t){if(t instanceof w.NoFallbackError||await z.onRequestError(e,t,{routerKind:"App Router",routePath:V,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:P})},!1,C),H)throw t;return await (0,f.sendResponse)(j,B,new Response(null,{status:500})),null}}e.s(["handler",()=>Y,"patchFetch",()=>J,"routeModule",()=>z,"serverHooks",()=>Q,"workAsyncStorage",()=>G,"workUnitAsyncStorage",()=>K],45068)}];

//# sourceMappingURL=2374f_next_dist_esm_build_templates_app-route_ef9f2b8d.js.map